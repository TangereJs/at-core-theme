<link rel="import" href="../polymer/polymer.html">


<polymer-element name="at-core-theme" hidden attributes="palette">
  <script>
    (function () {

      // share g with core-style
      window.CoreStyle = window.CoreStyle || {
        g: {},
        list: {},
        refMap: {}
      };

      // initialize default theme values
      if (!window.CoreStyle.g.theme) {
        window.CoreStyle.g.theme = {};
        var t = window.CoreStyle.g.theme;
        t.colorTwo = '#123456';
      }


      Polymer('at-core-theme', {
        publish: {
          theme: {
            value: '',
            reflect: true
          }
        },
        // static
        g: CoreStyle.g,
        list: CoreStyle.list,

        ready: function () {
          this.themeChanged();

        },

        themeChanged: function () {

          // is theme already loaded?
          if(window.CoreStyle.g.theme.name == this.theme) return;
          if(window.CoreStyle.g.theme.name && !this.theme) return;
          
          // set default theme name
          if(!this.theme) this.theme = "carbon";
          
          var url = "/components/at-core-theme/dist/" + this.theme + "/semantic.css";
          var cssref = document.getElementById("at-core-theme");

          if (!cssref) {
            cssref = document.createElement("link");
            cssref.setAttribute("rel", "stylesheet");
            cssref.setAttribute("type", "text/css");
            cssref.setAttribute("id", "at-core-theme");
            cssref.setAttribute("href", url);

            document.getElementsByTagName("head")[0].appendChild(cssref);

          } else {
            cssref.setAttribute("href", url);
          }

          console.log("theme changed to: " + this.theme);
          window.CoreStyle.g.theme.name = this.theme;
        }

      });

    })();
  </script>
</polymer-element>
